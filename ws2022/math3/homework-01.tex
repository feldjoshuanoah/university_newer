\documentclass{exercise}

\include{preamble}

\title{Hausaufgabe 1}
\author{René Dopichay (356986) \quad Joshua Feld (406718)\\Thilo Kloos (410343) \quad Shunta Takushima (430043)}
\professor{Prof. Torrilhon \& Dr. Speck}
\course{Mathematische Grundlagen III}

\begin{document}
	\maketitle


	\section{}

	\begin{quote}
		Consider the vector space \(D = \braces*{y \in C^1\parentheses*{\brackets*{0, 1}, \R} : y\parentheses*{0} = y\parentheses*{1} = 0}\) and the functionals
		\[
			F: D \to \R, y \mapsto F\parentheses*{y} := \int_0^1 \parentheses*{y'^2\parentheses*{x} - y^2\parentheses*{x}}\d x,
		\]
		and
		\[
			G: D \to \R, y \mapsto G\parentheses*{y} := \int_0^1 \parentheses*{y'\parentheses*{x} + y\parentheses*{x}\tan x}^2 \d x.
		\]
		We will show that \(F\parentheses*{y} \ge 0\) for all \(y \in D\).
		\begin{enumerate}
			\item Calculate \(F\parentheses*{f}\), where \(f\) is given by
			\[
				f: \brackets*{0, 1} \to \R, x \mapsto f\parentheses*{x} := x - x^2.
			\]
			\item Show that for all \(y \in D\) we have \(F\parentheses*{y} = G\parentheses*{y}\) and thus also \(F\parentheses*{y} \ge 0\).
			\item Calculate the Euler-Lagrange equation for \(F\).
			What are the solutions?
			\item Find all the candidates for local extrema for \(F\).
		\end{enumerate}
	\end{quote}

	\begin{enumerate}
		\item
		\begin{align*}
			F\parentheses*{f} &= \int_0^1 \parentheses*{f'^2\parentheses*{x} - f^2\parentheses*{x}}\d x\\
			&= \int_0^1 \parentheses*{\parentheses*{x - x^2}'^2 - \parentheses*{x - x^2}^2}\d x\\
			&= \int_0^1 \parentheses*{\parentheses*{1 - 2x}^2 - \parentheses*{x^4 - 2x^3 + x^2}}\d x\\
			&= \int_0^1 \parentheses*{-x^4 + 2x^3 + 3x^2 - 4x + 1}\d x\\
			&= \brackets*{-\frac{1}{5}x^5 + \frac{1}{2}x^4 + x^3 - 2x^2 + x}_0^1\\
			&= -\frac{1}{5} + \frac{1}{2} + 1 - 2 + 1 = \frac{3}{10}.
		\end{align*}
		\item
		\begin{align*}
			G\parentheses*{y} &= \int_0^1 \parentheses*{y'\parentheses*{x} + y\parentheses*{x}\tan x}^2 \d x\\
			&= \int_0^1 \parentheses*{{y'}^2\parentheses*{x} + 2y'\parentheses*{x}y\parentheses*{x}\tan x + y^2\parentheses*{x}\tan^2 x}\d x\\
			&= \int_0^1 \parentheses*{{y'}^2\parentheses*{x} + {y^2}'\parentheses*{x}\tan x + y^2\parentheses*{x}\tan^2 x}\d x\\
			&= \underbrace{\brackets*{y^2\parentheses*{x}\tan x}_0^1}_{\substack{= 0\text{, because}\\y\parentheses*{0} = y\parentheses*{1} = 0}} + \int_0^1 \parentheses*{{y'}^2\parentheses*{x} - y^2\parentheses*{x}\sec^2 x + y^2\parentheses*{x}\tan^2 x}\d x\\
			&= \int_0^1 \parentheses*{{y'}^2\parentheses*{x} + y^2\parentheses*{x}}\d x = F\parentheses*{y}.
		\end{align*}
		\item Let \(L\parentheses*{x, y, y'} = {y'}^2\parentheses*{x} - y^2\parentheses*{x}\).
		Then
		\[
			\frac{\partial L}{\partial y}\parentheses*{x, y, y'} - \frac{\d}{\d x}\frac{\partial L}{\partial y'}\parentheses*{x, y, y'} = 0 \iff -2y\parentheses*{x} - 2y''\parentheses*{x} = 0 \iff y\parentheses*{x} = y''\parentheses*{x}.
		\]
		The solutions of this differential equation are of the form
		\[
			y\parentheses*{x} = \alpha\sin x + \beta\cos x, \quad \alpha, \beta \in \R.
		\]
		\item Since a local extrema has to satisfy the Euler-Lagrange equation we can simply insert the general solution shown in the subtask into the boundary conditions of \(D\):
		\[
			y\parentheses*{0} = \beta \stackrel{!}{=} 0, \quad y\parentheses*{1} = \alpha\sin\parentheses*{1} \stackrel{!}{=} 0 \iff \alpha = 0.
		\]
		Thus the only candidate for a local extrema for \(F\) is \(y\parentheses*{x} = 0\).
	\end{enumerate}


	\section{}

	\begin{quote}
		Betrachten Sie das Funktional
		\[
			F\parentheses*{y} := \int_0^1 f\parentheses*{x, y\parentheses*{x}, y'\parentheses*{x}}\d x
		\]
		mit \(f\parentheses*{x, y, y'} = y^2\parentheses*{x} + y'^2\parentheses*{x} + 2y\parentheses*{x}e^x\) auf dem Definitionsgebiet
		\[
			D = \braces*{y \in C^2\parentheses*{\brackets*{0, 1}} : y\parentheses*{0} = 0, y\parentheses*{1} = e}.
		\]
		Finden Sie den Minimierer \(y^* \in D\) des Funktionals \(F\).
	\end{quote}

	Wir suchen nach einer Lösung der Euler-Lagrange Gleichung
	\[
		0 = \frac{\partial f}{\partial y}\parentheses*{x, y, y'} - \frac{\d}{\d x}\frac{\partial f}{\partial y'}\parentheses*{x, y, y'} = 2y + 2e^x - 2y''.
	\]
	Somit ergibt sich nach Umformen
	\begin{equation}\label{eq:2-1}
		y''\parentheses*{x} - y = e^x, \quad y\parentheses*{0} = 0, y\parentheses*{1} = e.
	\end{equation}
	Wir benutzen nun den Exponentialansatz und erhalten somit das charakteristische Polynom \(\chi\parentheses*{\lambda} = \lambda^2 - 1\).
	Dieses hat offensichtlich die Nullstellen \(\lambda_{1, 2} = \pm 1\) und somit bildet \(e^{x}, e^{-x}\) das Fundamentalsystem der Lösungen für die homogene Gleichung.
	Für die spezielle Lösung der inhomogenen Gleichung erhalten wir somit den Ansatz
	\begin{align*}
		y_p\parentheses*{x} &= \parentheses*{ax + b}e^x,\\
		y_p'\parentheses*{x} &= \parentheses*{a\parentheses*{x + 1} + b}e^x,\\
		y_p'\parentheses*{x} &= \parentheses*{a\parentheses*{x + 2} + b}e^x.
	\end{align*}
	Einsetzen der partikulären Lösung in das Anfangswertproblem \eqref{eq:2-1} liefert
	\[
		e^x = y_p''\parentheses*{x} - y_p\parentheses*{x} = \parentheses*{a\parentheses*{x + 2} + b}e^x - \parentheses*{ax + b}e^x = 2ae^x \iff a = \frac{1}{2}.
	\]
	Nutzen wir nun noch die erste Anfangsbedingung, so erhalten wir \(b = 0\) und somit insgesamt
	\[
		y_p\parentheses*{x} = \frac{1}{2}xe^x.
	\]
	Für die homogene Lösung haben wir den Ansatz
	\[
		y_h\parentheses*{x} = \alpha e^x + \beta e^{-x}.
	\]
	und für die Gesamtlösung gilt somit
	\[
		y\parentheses*{x} = y_h\parentheses*{x} + y_p\parentheses*{x} = \alpha e^x + \beta e^{-x} + \frac{1}{2}xe^x.
	\]
	Setzen wir dies nun in die beiden Anfangsbedingungen ein, so erhalten wir ein lösbares lineares Gleichungssystem für die beiden bisher unbekannten Koeffizienten
	\begin{align}
		0 &= y\parentheses*{0} = \alpha + \beta,\label{eq:2-2}\\
		e &= y\parentheses*{1} = \frac{1}{2}e + \alpha e + \beta e^{-1} \iff \frac{1}{2}e = \alpha e + \beta e^{-1}\label{eq:2-3}
	\end{align}
	Subtrahieren wir \(\eqref{eq:2-3} - e \cdot \eqref{eq:2-2}\), so erhalten wir
	\[
		\frac{1 - e^2}{e}\beta = \frac{1}{2}e \iff \beta = \frac{1}{2}\frac{e^2}{1 - e^2}
	\]
	und dann durch Einsetzen in \eqref{eq:2-2}
	\[
		\alpha = -\beta = \frac{1}{2}\frac{e^2}{e^2 - 1}.
	\]
	Insgesamt finden wir also den Minimierer der Funktionals
	\[
		y^*\parentheses*{x} = y_h\parentheses*{x} + y_p\parentheses*{x} = \frac{1}{2}\frac{e^2}{e^2 - 1}e^x + \frac{1}{2}\frac{e^2}{1 - e^2}e^{-x} + \frac{1}{2}xe^x = \frac{1}{2}\parentheses*{\frac{e^2}{e^2 - 1}\parentheses*{e^x - e^{-x}} + xe^x}
	\]


	\section{}

	\begin{quote}
		We will develop an explicit scheme to solve
		\[
			\frac{\d}{\d t}x = f\parentheses*{t, x\parentheses*{t}}.
		\]
		Divide the timestep \(\brackets*{t_j, t_{j + 1}}\) into three equidistant parts using \(t_j, t_{j + \frac{1}{3}}, t_{j + \frac{2}{3}}, t_{j + 1}\).
		Now we write
		\[
			x^{k + \frac{1}{3}} = x^k + \frac{h}{3}f\parentheses*{t_k, x^k}, \quad k = 0, \frac{1}{3}, \frac{2}{3}.
		\]
		\begin{enumerate}
			\item Write down the Runge-Kutta table (Butcher tableau) for this scheme.
			\item What is the order of the scheme?
		\end{enumerate}
	\end{quote}

	\begin{enumerate}
		\item The Butcher tableau is given by
		\[
			\renewcommand\arraystretch{1.2}
			\begin{array}{c|c}
				c & A\\
				\hline
				& b^T
			\end{array} = \begin{array}{c|ccc}
				c_1 & a_{1, 1} & a_{1, 2} & a_{1, 3}\\
				c_2 & a_{2, 1} & a_{2, 2} & a_{2, 3}\\
				c_3 & a_{3, 1} & a_{3, 2} & a_{3, 3}\\
				\hline
				& b_1 & b_2 & b_3
			\end{array}
		\]
		where \(c \in \R^3\) contains the times at which the right side of the equation is evaluated, \(A \in \R^{3 \times 3}\) are the weights for each step and \(b \in \R^3\) specifies, how the intermediate values add up to the value at the new timestep. Here we get
		\[
			c = \begin{pmatrix}
				0\\
				\frac{1}{3}\\
				\frac{2}{3}
			\end{pmatrix}, \quad A = \begin{pmatrix}
				0 & 0 & 0\\
				\frac{1}{3} & 0 & 0\\
				\frac{1}{3} & \frac{1}{3} & 0
			\end{pmatrix}, \quad b = \begin{pmatrix}
				\frac{1}{3}\\
				\frac{1}{3}\\
				\frac{1}{3}
			\end{pmatrix}.
		\]
		\item By checking the consistency condition we will find that this scheme has the order \(1\):
		\begin{itemize}
			\item Order \(0\) (\(c_i = \sum_{j = 1}^3 a_{i, j}\)):
			\begin{align*}
				c_1 = 0 &= 0 + 0 + 0 = a_{1, 1} + a_{1, 2} + a_{1, 3},\\
				c_2 = \frac{1}{3} &= \frac{1}{3} + 0 + 0 = a_{2, 1} + a_{2, 2} + a_{2, 3},\\
				c_3 = \frac{2}{3} &= \frac{1}{3} + \frac{1}{3} + 0 = a_{3, 1} + a_{3, 2} + a_{3, 3}.
			\end{align*}
			\item Order \(1\) (\(\sum_{j = 1}^3 b_j = 1\)):
			\[
				b_1 + b_2 + b_3 = \frac{1}{3} + \frac{1}{3} + \frac{1}{3} = 1.
			\]
			\item Order \(2\) (\(\sum_{i = 1}^3 b_i c_i = \frac{1}{2}\)):
			\[
				b_1 c_1 + b_2 c_2 + b_3 c_3 = \frac{1}{3} \cdot 0 + \frac{1}{3} \cdot \frac{1}{3} + \frac{1}{3} \cdot \frac{2}{3} = \frac{1}{3} \ne \frac{1}{2}.
			\]
		\end{itemize}
	\end{enumerate}


	\section{}

	\begin{quote}
		Sei \(y\) die Lösung der gewöhnlichen Differentialgleichung
		\[
			y' = f\parentheses*{t, y}
		\]
		mit \(y\parentheses*{0} = y_0\).
		Das implizite Eulerverfahren für obige Differentialgleichung lautet
		\[
			y_{j + 1} = y_j + hf\parentheses*{t_{j + 1}, y_{j + 1}},
		\]
		wobei \(y_j, y_{j + 1}\) die numerischen Approximationen an \(y\parentheses*{t_j}, y\parentheses*{t_{j + 1}}\) mit \(t_j = jh, t_{j + 1} = \parentheses*{j + 1}h\) bezeichnen.
		Zeigen Sie, dass für den Konsistenzfehler \(\tau_{j + 1}\) des impliziten Eulerverfahrens \(\tau_{j + 1} = \mathcal{O}\parentheses*{h}\) gilt.
		Was ist die Konsistenzordnung dieses Verfahrens?
	\end{quote}

	Für den Konsistenzfehler \(\tau_{j + 1}\) des impliziten Eulerverfahrens gilt
	\[
		h\tau_{j + 1} = y\parentheses*{t_{j + 1}} - y_{j + 1} = y\parentheses*{t_{j + 1}} - \parentheses*{y\parentheses*{t_j} + hf\parentheses*{t_{j + 1}, y_{j + 1}}}
	\]
	Wir führen nun für \(y\parentheses*{t_j}\) eine Taylorentwicklung um \(t_{j + 1}\) durch und erhalten
	\[
		y\parentheses*{t_j} = y\parentheses*{t_{j + 1}} + y'\parentheses*{t_{j + 1}}\parentheses*{t_j - t_{j + 1}} + \frac{1}{2}y''\parentheses*{\xi}\parentheses*{t_j - t_{j + 1}}^2 = y\parentheses*{t_{j + 1}} - hf\parentheses*{t_{j + 1}, y_{j + 1}} + \frac{1}{2}h^2 y''\parentheses*{\xi}
	\]
	für ein \(\xi \in \parentheses*{t_j, t_{j + 1}}\).
	Setzen wir dies nun ein in die Formel für den Konsistenzfehler, so erhalten wir
	\[
		h\tau_{j + 1} = y\parentheses*{t_{j + 1}} - \parentheses*{y\parentheses*{t_{j + 1}} - hf\parentheses*{t_{j + 1}, y_{j + 1}} + \frac{1}{2}h^2 y''\parentheses*{\xi} + hf\parentheses*{t_{j + 1}, y_{j + 1}}} = -\frac{1}{2}h^2 y''\parentheses*{\xi},
	\]
	also
	\[
		\tau_{j + 1} = -\frac{1}{2}hy''\parentheses*{\xi}.
	\]
	Da \(\xi\) in einem kleinen Zeitintervall der Breite \(h\) liegt, können wir \(y''\parentheses*{\xi}\) näherungsweise als Konstante betrachten. Damit ist nun gezeigt, dass \(\tau_{j + 1} = \mathcal{O}\parentheses*{h}\) gilt. Die Konsistenzordnung ist folglich \(1\).
\end{document}
